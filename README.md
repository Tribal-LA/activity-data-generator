# Activity Data Generator
A simple Python 2.7 utility to generate data in a tabular CSV form suitable for either templated generation of xAPI JSON statements or direct loading into a data pipeline. This is an early-stage alpha-grade utility intended for developer-level use.

Refer to [copyright_contributors.md](copyright_contributors.md) for copyright and license matters, and information on how to contribute.

## Introduction
The aim is to have MOST of the generation work done based on some JSON config files but not necessarily ALL work. Core generation code is in generator/generator.py, and consists of classes to deal with generation as a three part process:
- generation of person-group data, according to a JSON config in membership_definitions, or (__TODO__) use of externally-supplied person-group data. This is covered under "Membership Definition", below. A single membership definition may be used to generate several datasets. This JSON file is used by class `Memberships`.
- creation of single event records (i.e. records of a single action as would be recorded as an xAPI Statement), given a column-level generator model. Models are meant to be quite simple representations of activity patterns. Their specification is covered in "Model Definition". This JSON file is used by class `Models`.
- preparation of datasets, comprising a potentially large number of event records generated by one or more models, and related to some membership identifiers. The configuration is covered in "Dataset Definition". This JSON file is used by class `Dataset`.

In a normal usage scenario - generating a set of data for each of several kinds of activity, but for the same group of students - an instance of `Memberships` is used initially, only once, followed by several instances of `Dataset`. The `Models` class is used indirectly by `Dataset`.

This may be done:
- from the command line using something like `python -m wrapper test1_wrapper`, to make use of the file config/test1_wrapper.json (see [configuration documentation](configuration.md)),
- in code using wrapper.GeneratorWrapper class, passing it a Wrapper JSON configuration file name such as 'test1_wrapper'. This also allows for control of the location of the output and configuration directories.
-  more explicitly in code, for example:

```
# create and save memberships CSV
m = Memberships("mset_test", config_dir='config', output_dir=output_dir)
m.generate_ids()

# create and save each dataset.
d1 = Dataset("ATTENDANCE", "test1", config_dir='config', output_dir=output_dir)
d1.apply_models()
d1.to_csv()
d2 = Dataset("LIBRARY", "test1", config_dir='config', output_dir=output_dir)
d2.apply_models()
d2.to_csv()
```

Each stage in the three part process has the potential for random number generation or randomised choice, such that the final dataset could well exhibit quite a complicated combination of underlying patterns, although the patterns themselves are quite simple.

The aim is to have MOST of the generation work done based the JSON config files but not necessarily for this to cover ALL columns; application-specific Python files may be created in the 'generators' directory, inheriting from the `generator.Dataset` class, to implement non-general generation rules. For example, it may be easier to use a 2 stage process where independently generatable columns are generated according to JSON rules and dependencies coded manually (for example the Jisc attendance recipe has attendance-category and attendance-late, so we might only generate one and write a hard-coded rule for the relationship). See `generators/attendance.py` for an example derived class.

One KEY omission (at present, a __TODO__) is any linking to UDD data, although the design of `Memberships` is intended to accommodate a step in which pre-existing group-membership data is used in place of the automatically-generated memberships. Additional work will be needed to blend-in student outcomes and mapping them to agent stereotypes (see below). In the membership csv output, "group_set" may be conveniently matched to UDD COURSE_INSTANCE_ID.

## Generator Behaviour
The generator is supplied with the location of a dataset definition JSON file.

One output, containing n\_records will be created for each required academic year.

For the time being, academic years are assumed to start on the Monday following September 1st.

## See Also
More information on using the Activity Data Generator:
- [Configuration File structure](configuration.md)
- [How to deal with particular scenarios](how_to.md)

Background information:
- The Activity Data Generator was built* to work alongside systems and data built to work using:
 - the [Jisc Unified Data Definitions](https://github.com/jiscdev/analytics-udd) (UDD) for administrative data;
 - activity data following the xAPI actor-verb-object formalism, particularly following the [Jisc xAPI Recipes](https://github.com/jiscdev/xapi).

\* - this should not mean that it cannot be used in other contexts, but there is terminology and a set of core assumptions which this implies.
